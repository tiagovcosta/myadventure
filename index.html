<!DOCTYPE html>
<html data-ng-app="youradventure">
<head>
    <title>My Adventure</title>

    <link rel="stylesheet" href="bootstrap.min.css">

    <script src="gl-matrix/common.js"></script>
    <script src="gl-matrix/vec2.js"></script>
    <script src="gl-matrix/vec3.js"></script>
    <script src="gl-matrix/vec4.js"></script>
    <script src="gl-matrix/mat4.js"></script>
    <script src="jquery-2.1.1.min.js"></script>
    <script src="angular.min.js"></script>
    <script src="Box2dWeb-2.1.a.3.js"></script>

    <script src="input.js"></script>
    <script src="utilities.js"></script>
    <script src="scripts.js"></script>
    <script src="physics.js"></script>
    <script src="renderer.js"></script>
    <script src="game.js"></script>
    <script src="code.js"></script>
    
    <link href="bootstrap-colorpicker-master/dist/css/bootstrap-colorpicker.min.css" rel="stylesheet">
    <script src="bootstrap-colorpicker-master/dist/js/bootstrap-colorpicker.min.js"></script>

    <!-- Fragment shader program -->
    <script id="shader-fs" type="x-shader/x-fragment">
        uniform highp vec4 color;
        
        void main(void)
        {
            gl_FragColor = color;
        }
    </script>
    
    <!-- Vertex shader program -->
    <script id="shader-vs" type="x-shader/x-vertex">
      attribute vec3 aVertexPosition;
    
      uniform mat4 uWMatrix;
      uniform mat4 uVPMatrix;
    
      void main(void)
      {
        gl_Position = uVPMatrix * uWMatrix * vec4(aVertexPosition, 1.0);
      }
    </script>

</head>
<body id="body" data-ng-controller="MainCtrl" onload="init()">

    <div class="container-fluid">
        <div></div>

        <canvas id="canvas"
                width="640" height="480"
                tabindex="0"
                data-ng-mousedown="mouseDown($event)"
                data-ng-mouseup="mouseUp()"
                data-ng-mouseout="mouseUp()"
                data-ng-mousemove="mouseMove()">
        </canvas>

        <!--/////////////////////-->
        <!-- GAME CUSTOMIZATION /-->
        <!--/////////////////////-->

        <p>
            RUNNING: <input type="checkbox"
                            data-ng-model="running">
        </p>
        <p>Background color: <input type="text" class="colorpick"
                                    data-ng-model="backgroundColor"></p>

        <p>View distance: <input type="number"
                                 data-ng-model="viewDistance"></p>

        <!--//////////////////////-->
        <!-- ACTOR CUSTOMIZATION /-->
        <!--//////////////////////-->

        <p>
            <input type="button" value="New Actor"
                   data-ng-disabled="game.running"
                   onclick="game.addActor(vec3.fromValues(10,10,-4),
                            vec3.fromValues(5,5,1),
                            0,
                            vec4.fromValues(0.0,0.5,0.8,1),
                            b2Body.b2_dynamicBody)">
        </p>

        <p><span id="helper_span"></span></p>

        <div data-ng-show="selectedActor !== null">
            <h2> Selected Actor:</h2>
            <p>Name: <input type="text"
                            data-ng-model="selectedActor.name"></p>
            <p>Color: <input type="color"
                             data-ng-model="selectedColor"></p>
            <p>Script: <select data-ng-model="selectedActor.script"
                               data-ng-options="script.name for script in scripts"></select></p>
            <p>Type:
                <select data-ng-model="selectedActor.type"
                        data-ng-options="k for (k,v) in actorTypes"></select>
            </p>
            <p>Class: <input type="text"
                             data-ng-model="selectedActor.actorClass"></p>
        </div>

        <!--///////////////////////-->
        <!-- SCRIPT CUSTOMIZATION /-->
        <!--///////////////////////-->

        <h1>Scripts:</h1>
        <div data-ng-repeat="script in scripts"
            data-ng-click="selectScript(script)">
            {{script.name}}
        </div>

        <p><input type="button" value="New Script"
                  data-ng-click="game.newScript()"></p>

        <div data-ng-if="selectedScript !== null">
            <h2>Script Details:</h2>
            Name: <input type="text" data-ng-model="selectedScript.name">
            <p>Number of Rules: {{selectedScript.rules.length}}</p>

            <p><input type="button" value="New Rule"
                  data-ng-click="selectedScript.newRule()"></p>

            <div data-ng-repeat="rule in selectedScript.rules">
                <h3>Rule {{$index+1}}</h3>
                <h4>Conditions:</h4>
                <p data-ng-repeat="condition in rule.conditions">
                    Not <input type="checkbox" data-ng-model="condition.args.not">
                    {{condition.snippet.name}} ->
                    <span data-ng-repeat="argument in condition.snippet.argsDescs">{{argument.name}} =
                        <span data-ng-switch="argument.type">
                            <span data-ng-switch-when="select">
                                <select data-ng-model="condition.args[argument.name]"
                                        data-ng-options="key for (key, value) in argument.selectOptions"></select>
                            </span>
                            <span data-ng-switch-when="text">
                                <input type="text" data-ng-model="condition.args[argument.name]">
                            </span>
                            <span data-ng-switch-when="number">
                                <input type="number" data-ng-model="condition.args[argument.name]">
                            </span>
                        </span>
                    </span>
                </p>

                New Condition:
                <select data-ng-model="newCondition"
                        data-ng-options="cond.name for cond in conditions"></select>
                <input type="button" value="Create"
                       data-ng-click="rule.newCondition(newCondition)">

                <h4>Actions:</h4>
                <p data-ng-repeat="action in rule.actions">
                     {{action.snippet.name}} ->
                    <span data-ng-repeat="argument in action.snippet.argsDescs">{{argument.name}} =
                        <span data-ng-switch="argument.type">
                            <span data-ng-switch-when="select">
                                <select data-ng-model="action.args[argument.name]"
                                        data-ng-options="key for (key, value) in argument.selectOptions"></select>
                            </span>
                            <span data-ng-switch-when="text">
                                <input type="text" data-ng-model="action.args[argument.name]">
                            </span>
                            <span data-ng-switch-when="number">
                                <input type="number" data-ng-model="action.args[argument.name]">
                            </span>
                        </span>
                    </span>
                </p>

                New Action:
                <select data-ng-model="newAction"
                        data-ng-options="action.name for action in actions"></select>
                <input type="button" value="Create"
                       data-ng-click="rule.newAction(newAction)">
            </div>

        </div>

    </div>

</body>
</html>
